---
title: "Omics - Analysis of large-scale biomolecular datasets"
subtitle: "KIMN20 - LTH"
author: 
  - "Daniel Nilsson"
  - "Massimiliano Volpe"
date: today
format: 
  revealjs:
    width: 1050
    height: 700
    margin: 0.1
    center: false
    self-contained: true
    css: custom.css
    logo: assets/lth-logo.png
    code-fold: false
  ipynb: default
engine: knitr
execute:
  enabled: true
  echo: true
---

## Introduction to R

### Course date: 04 November 2025
### Last modified: {{< meta date >}}

## Welcome to R Programming! üêß

This presentation will teach you the fundamentals of R programming for data analysis.

### What we'll cover:
- R language basics and getting help
- Working with packages
- Variables and data types
- Data structures (vectors, matrices, lists, data frames)
- Reading data from files
- Writing functions

---

## Getting Started with R

### Opening R/RStudio

- **RStudio**: Download from https://posit.co/download/rstudio-desktop/
- **Web-based**: Use RStudio Cloud or Google Colab with R kernel
- **Command line**: Type `R` in terminal

### Your First R Commands

```r
# This is a comment - it won't execute
print("Hello, R!")
```

Try running this command in your R console!

### R as a Calculator

```{r eval: true}
# Basic arithmetic
2 + 3
10 - 4
5 * 6
20 / 4
2^3
```

---

## Getting Help

### Built-in Help Functions

```r
# Get help for a function
?print
help(print)

# Search for functions
??plot
help.search("plot")
```

### Help for Packages

```r
# Get help for installed packages
help(package = "base")

# Vignettes (detailed tutorials)
vignette()
vignette("ggplot2")
```

---

## Working with Packages

### Installing Packages

```r
# Install from CRAN (main repository)
install.packages("tidyverse")

# Install multiple packages
install.packages(c("dplyr", "ggplot2", "readr"))
```

### Loading Packages

```r
# Load a package
library(tidyverse)

# Load with require() (returns TRUE/FALSE)
require(tidyverse)
```

### Package Management

```r
# See loaded packages
sessionInfo()

# Update packages
update.packages()

# Remove packages
remove.packages("package_name")
```

---

## Variables and Assignment

### Creating Variables

```r
# Assignment operators
x <- 5
y = 10
20 -> z

# Print variables
x
print(y)
```

### Variable Names

```r
# Valid names
my_variable <- 1
myVariable <- 2
.variable <- 3
variable. <- 4

# Invalid names (would cause errors)
# 1variable <- 5
# my-variable <- 6
# my variable <- 7
```

---

## Data Types and Classes

### Basic Data Types

```r
# Numeric (double)
num <- 3.14
class(num)

# Integer
int <- 42L
class(int)

# Character (string)
text <- "Hello World"
class(text)

# Logical (boolean)
logic <- TRUE
class(logic)
```

### Type Checking

```r
# Check data types
is.numeric(num)
is.integer(int)
is.character(text)
is.logical(logic)

# Check if it's a specific type
is.double(num)
is.integer(int)
```

---

## Type Casting and Conversion

### Converting Between Types

```r
# Numeric to character
as.character(3.14)

# Character to numeric
as.numeric("42.5")

# Numeric to integer
as.integer(3.9)

# Logical to numeric
as.numeric(TRUE)  # Returns 1
as.numeric(FALSE) # Returns 0
```

### Common Conversions

```r
# String to logical
as.logical("TRUE")
as.logical("false")

# Factor to character
factor_var <- factor(c("A", "B", "A"))
as.character(factor_var)
```

---

## Basic String Operations

### String Basics

```r
# Create strings
name <- "Alice"
greeting <- 'Hello'

# String length
nchar(name)

# Combine strings
paste("Hello", "World")
paste("Hello", "World", sep = " ")
```

### String Manipulation

```r
# Substring
substr("Hello World", 1, 5)

# Upper/lower case
toupper("hello")
tolower("WORLD")

# Split strings
strsplit("Hello World", " ")
```

---

## Atomic Vectors

### Creating Vectors

```r
# Numeric vector
numbers <- c(1, 2, 3, 4, 5)
numbers

# Character vector
fruits <- c("apple", "banana", "orange")
fruits

# Logical vector
booleans <- c(TRUE, FALSE, TRUE)
booleans
```

### Vector Operations

```r
# Vector arithmetic
x <- c(1, 2, 3)
y <- c(4, 5, 6)
x + y
x * y

# Vector functions
length(numbers)
sum(numbers)
mean(numbers)
```

---

### Vector Indexing

```r
# Access elements
fruits[1]      # First element
fruits[2:3]    # Second and third
fruits[c(1,3)] # First and third

# Negative indexing (exclude)
fruits[-1]     # All except first
fruits[-c(1,3)] # Exclude first and third
```

### Named Vectors

```r
# Create named vector
ages <- c(Alice = 25, Bob = 30, Carol = 35)
ages

# Access by name
ages["Alice"]
ages[c("Alice", "Carol")]
```

---

## Matrices

### Creating Matrices

```r
# Create matrix from vector
matrix(1:9, nrow = 3, ncol = 3)

# By row or column
matrix(1:6, nrow = 2, byrow = TRUE)
matrix(1:6, nrow = 2, byrow = FALSE)
```

### Matrix Operations

```r
# Create sample matrix
m <- matrix(1:4, nrow = 2)
m

# Matrix dimensions
dim(m)
nrow(m)
ncol(m)
```

---

### Matrix Indexing

```r
# Access elements
m[1, 2]    # Row 1, Column 2
m[1, ]     # Entire row 1
m[, 2]     # Entire column 2

# Multiple elements
m[1:2, 1]  # Rows 1-2, Column 1
```

### Matrix Arithmetic

```r
# Matrix operations
m1 <- matrix(1:4, nrow = 2)
m2 <- matrix(5:8, nrow = 2)

m1 + m2
m1 * m2  # Element-wise
m1 %*% m2 # Matrix multiplication
```

---

## Lists

### Creating Lists

```r
# Simple list
my_list <- list(1, "hello", TRUE)
my_list

# Named list
person <- list(
  name = "Alice",
  age = 25,
  scores = c(85, 90, 88)
)
person
```

### Accessing List Elements

```r
# By index
person[[1]]  # First element
person[[3]]  # Third element

# By name
person$name
person[["age"]]
person$scores
```

---

### List Operations

```r
# List length
length(person)

# Names of elements
names(person)

# Add elements
person$city <- "Stockholm"
person

# Remove elements
person$city <- NULL
person
```

---

## Data Frames

### Creating Data Frames

```r
# Create data frame
students <- data.frame(
  name = c("Alice", "Bob", "Carol"),
  age = c(20, 21, 19),
  grade = c("A", "B", "A")
)
students
```

### Data Frame Properties

```r
# Structure
str(students)

# Dimensions
dim(students)
nrow(students)
ncol(students)

# Column names
names(students)
```

---

### Data Frame Indexing

```r
# Access columns
students$name
students[["age"]]
students[, 2]  # Second column

# Access rows
students[1, ]  # First row
students[1:2, ] # First two rows

# Access specific elements
students[1, 2]  # Row 1, Column 2
students[1, "age"] # Row 1, age column
```

### Data Frame Operations

```r
# Add column
students$passed <- c(TRUE, TRUE, FALSE)
students

# Summary statistics
summary(students)

# View first/last rows
head(students)
tail(students)
```

---

## Reading Data

### Reading CSV Files

```r
# Read CSV file
data <- read.csv("data.csv")
data

# With custom options
data <- read.csv("data.csv", 
                 header = TRUE,
                 sep = ",",
                 stringsAsFactors = FALSE)
```

### Reading Excel Files

```r
# Install readxl if needed
# install.packages("readxl")
library(readxl)

# Read Excel file
excel_data <- read_excel("data.xlsx")
excel_data

# Read specific sheet
sheet_data <- read_excel("data.xlsx", sheet = "Sheet1")
```

---

### Other File Formats

```r
# Read tab-separated file
tsv_data <- read.delim("data.tsv")

# Read from URL
url_data <- read.csv("https://example.com/data.csv")

# Write data
write.csv(students, "students.csv")
write.csv(students, "students.csv", row.names = FALSE)
```

---

## Writing Functions

### Basic Function Structure

```r
# Simple function
greet <- function(name) {
  message <- paste("Hello,", name, "!")
  return(message)
}

# Call the function
greet("Alice")
```

### Functions with Multiple Parameters

```r
# Function with multiple parameters
calculate_bmi <- function(weight_kg, height_m) {
  bmi <- weight_kg / (height_m^2)
  return(bmi)
}

# Usage
calculate_bmi(70, 1.75)
```

---

### Functions with Default Values

```r
# Function with defaults
power_function <- function(x, power = 2) {
  result <- x^power
  return(result)
}

# Usage
power_function(3)      # Uses default power = 2
power_function(3, 3)   # Uses power = 3
```

### Functions with Conditional Logic

```r
# Function with if-else
grade_letter <- function(score) {
  if (score >= 90) {
    return("A")
  } else if (score >= 80) {
    return("B")
  } else if (score >= 70) {
    return("C")
  } else {
    return("F")
  }
}

# Usage
grade_letter(85)
grade_letter(92)
```

---

## Practice Time! üíª

### Exercise 1: Variables and Types

1. Create variables for your name, age, and height
2. Check their data types with `class()`
3. Convert your age to character and height to integer

```r
# Your code here
name <- "Your Name"
age <- 25
height <- 1.75

class(name)
class(age)
class(height)

as.character(age)
as.integer(height)
```

---

### Exercise 2: Vectors and Data Frames

1. Create a vector of your favorite numbers
2. Create a data frame with names and scores
3. Calculate the mean of the scores

```r
# Your code here
numbers <- c(1, 5, 10, 15, 20)

scores_df <- data.frame(
  name = c("Alice", "Bob", "Carol"),
  score = c(85, 92, 78)
)

mean(scores_df$score)
```

---

## Quiz Time! üß†

### Question 1
Which operator is used for assignment in R?
- A) `=`
- B) `<-`
- C) Both A and B

### Question 2
What function creates a vector in R?
- A) `vector()`
- B) `c()`
- C) `make_vector()`

### Question 3
How do you access the first element of a vector named `my_vec`?
- A) `my_vec[0]`
- B) `my_vec[1]`
- C) `my_vec.first`

*(Answers: 1-C, 2-B, 3-B)*

---

## Thank You!

You've completed the basic R programming tutorial!

### Remember:
- Use `?function_name` for help
- Install packages with `install.packages()`
- Load packages with `library()`
- Practice regularly with real data

### Questions?
Feel free to ask your instructor or classmates!

üêß Happy R programming! üêß

---

## Next Steps

### What to Learn Next

- Data manipulation with dplyr
- Data visualization with ggplot2
- Statistical analysis functions
- Writing R scripts and RMarkdown
- Advanced data structures
- Working with dates and times

### Resources

- [R for Data Science](https://r4ds.had.co.nz/) - Free online book
- [RStudio Education](https://education.rstudio.com/) - Learning resources
- [CRAN Task Views](https://cran.r-project.org/web/views/) - Package collections
- [R Documentation](https://www.rdocumentation.org/) - Function reference
